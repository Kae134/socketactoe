"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getPackageJson = exports.getProductionDependencies = exports.getAllDependencies = void 0;
const devkit_1 = require("@nx/devkit");
const fs_1 = require("fs");
const runtime_lint_utils_1 = require("./runtime-lint-utils");
function getAllDependencies(packageJson) {
    return {
        ...packageJson.dependencies,
        ...packageJson.devDependencies,
        ...packageJson.peerDependencies,
        ...packageJson.optionalDependencies,
    };
}
exports.getAllDependencies = getAllDependencies;
function getProductionDependencies(packageJsonPath) {
    if (!globalThis.projPackageJsonDeps ||
        !globalThis.projPackageJsonDeps[packageJsonPath] ||
        !(0, runtime_lint_utils_1.isTerminalRun)()) {
        const packageJson = getPackageJson(packageJsonPath);
        globalThis.projPackageJsonDeps = globalThis.projPackageJsonDeps || {};
        globalThis.projPackageJsonDeps[packageJsonPath] = {
            ...packageJson.dependencies,
            ...packageJson.peerDependencies,
            ...packageJson.optionalDependencies,
        };
    }
    return globalThis.projPackageJsonDeps[packageJsonPath];
}
exports.getProductionDependencies = getProductionDependencies;
function getPackageJson(path) {
    if ((0, fs_1.existsSync)(path)) {
        return (0, devkit_1.readJsonFile)(path);
    }
    return {};
}
exports.getPackageJson = getPackageJson;
